{% load staticfiles %}
<!DOCTYPE html>
<html style="width: 100%; height: 100%;">
<head>
    <meta charset="utf-8">
    {{ error }}
    {% if fileName %}
    <title>Edit PDF's: {{ fileName }}</title>
    {% else %}
    <!-- No Wabbit -->
    <title>Edit PDF's: Sorry. File Not Found :(</title>
    {% endif %}
    <!-- Jquery and Chained Selection-->
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="{% static "tuupola-jquery_chained-44a7f83/jquery.chained.js" %}"></script>
</head>
<body style="width: 100%; height: 100%;">
    {% if reload %}
    <!-- Reload page every 60s to check if the file is ready -->
    <script type="text/javascript">setTimeout("location.reload(true);",60000);</script>    
    {% endif %}
    <table style="width: 100%; height: 100%; max-width: 100%; min-width: 100%; max-height: 100%; table-layout: fixed;">
        <tr>
            <td rowspan="2">
                <div style=" width: 100%; height: 100%;">
                    <!-- Doc to Edit-->
                    {% if doc %}
                    <!-- Wabbit -->
                    <div style="width: 100%; height: 100%; overflow-y: hidden; overflow-x: hidden; white-space: nowrap;">
                        <embed src="{{ doc.docfile.url }}" style="width: 100%; height: 100%;"/>
                    </div>
                    {% else %}
                    <!-- No Wabbit -->
                    Sorry. File Not Found :(
                    {% endif %}
                </div>

            </td>
            <td rowspan="1">
                <div style=" width: 100%; height: 91%; overflow-y: auto; overflow-x: auto; white-space: nowrap;">
                    {{ error }}
                    {% if error %}
                    <p>Sorry. File Not Found :(</p>
                    {% else %}
                    <div style="height: 5%; text-align: left; margin: 1% 3% 3% 8%; "><button id="showOther">Show HTML</button></div>
                    <textarea class="input" id="textStringHTML" style="width: 100%; height: 95%; text-align: left; margin: 1% 3% 3% 8%;" value=":C"></textarea>
                    <div id="textString" contenteditable="true" style="height: 95%; text-align: left; margin: 1% 3% 3% 8%; "></div>
                    {% endif %}
                </div>
                <div><hr style="height: 9%;  color:gray; width:95%; size:1; margin-top:5%"></div>  
            </td>
        </tr>
        <tr>
            <td rowspan="1">
                <div style="width: 100%; height: 100%; overflow-y: auto; overflow-x: auto; white-space: nowrap; text-align: left; margin: 9% 3% 3% 8%; overflow:scroll;">
                    {{ error }}
                    {% if fileName %}
                        {% if program_form %}
                            {% if textstring_form %}
                            <form action="{% url 'edit' filePath=filePath fileName=fileName %}" method="post">
                            <form method="POST" action="{% url 'edit' filePath=filePath fileName=fileName %}" onsubmit="updateTextString(); loadTextstring();">
                                {% csrf_token %}
                                {{ program_form.as_p }}
                                <div style="display: inline;">{{ textstring_form.as_p }}</div>
                                </br>
                                <button type="submit" class="save btn btn-default">Salvar Cambios</button>
                            </form>
                            </form>
                            <script>$("#id_department").chained("#id_division");</script>
                            <script src="{% static "textStringHandler.js" %}"></script>
                            {% endif %}
                        {% endif %}
                    {% else %}
                    <p>Sorry. File Not Found :(</p>
                    {% endif %}
                </div>
            </th>
        </tr>
    </table>
</body>
</html>